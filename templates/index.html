<!-- ============================================
     PÁGINA DE INICIO
     Carrusel, ofertas especiales y promociones
     ============================================ -->
{% extends "base.html" %}

{% block title %}Inicio - Carnicería Pochito{% endblock %}

{% block extra_css %}
<!-- Archivo CSS consolidado con estilos de componentes y buscador -->
<link href="{{ url_for('static', filename='css/index.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- SECCIÓN PRINCIPAL -->
<section class="w-full max-w-6xl mx-auto mt-4 sm:mt-6 rounded-xl overflow-hidden shadow-2xl relative h-[300px] sm:h-[450px]">
    <img src="{{ url_for('static', filename='image/fachada.jpg') }}" 
        alt="Fachada Carnicería Pochito" 
        class="w-full h-full object-cover absolute inset-0 filter brightness-[.45]">

    <div class="relative z-10 flex flex-col items-center justify-center h-full text-white text-center px-4 sm:px-8">
        <h1 class="text-4xl sm:text-6xl lg:text-7xl font-extrabold tracking-tight mb-2 sm:mb-4 text-red-500 [text-shadow:_0_2px_4px_rgb(0_0_0_/_70%)]">
            POCHITO
        </h1>
        <p class="text-base sm:text-xl lg:text-2xl font-light mb-4 sm:mb-8">
            Los mejores cortes frescos, directo a tu mesa.
        </p>
        <a href="{{ url_for('productos') }}" 
            class="bg-red-600 text-white text-sm sm:text-lg px-6 sm:px-8 py-2 sm:py-3 rounded-full font-bold shadow-xl 
                   transition duration-300 transform hover:scale-105 hover:bg-red-700 
                   focus:outline-none focus:ring-4 focus:ring-red-500 focus:ring-opacity-50">
            VER PRODUCTOS
        </a>
    </div>
</section>

<!-- BUSCADOR -->
<section class="mega-search-wrap">
    <div class="search-input">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="#9CA3AF" stroke-width="2" stroke-linecap="round"/><circle cx="11" cy="11" r="6" stroke="#9CA3AF" stroke-width="2"/></svg>
        <input id="global-search" type="search" placeholder="Buscar cortes, parrillas y todo para asar..." aria-label="Buscar productos" autocomplete="off">
        <button id="search-clear" title="Limpiar" style="background:none;border:none;cursor:pointer;color:#9CA3AF">✕</button>
    </div>
    <div class="search-chips" id="search-chips">
        <div class="chip" data-q="Costillas">Costillas</div>
        <div class="chip" data-q="Lomo">Lomo</div>
        <div class="chip" data-q="Aguja">Aguja</div>
        <div class="chip" data-q="Chorizo">Chorizo</div>
        <div class="chip" data-q="Parrilla">Parrilla</div>
    </div>

    <div id="mega-results" class="mega-results" role="region" aria-live="polite">
        <div class="mega-columns">
            <div class="mega-col">
                <h4>Más buscados</h4>
                <div id="most-searched"></div>
            </div>
            <div class="mega-col">
                <h4>Resultados</h4>
                <div id="search-products"></div>
            </div>
            <div class="mega-col">
                <h4>Categorías</h4>
                <div id="search-categories">
                    <div class="chip" data-cat="res">Res</div>
                    <div class="chip" data-cat="cerdo">Cerdo</div>
                    <div class="chip" data-cat="pollo">Pollo</div>
                    <div class="chip" data-cat="ahumado">Ahumado</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- El array SITE_PRODUCTS se mantiene aquí para el archivo buscador.js -->
    <script>
        const SITE_PRODUCTS = [
            // Productos de res
            { img: "{{ url_for('static', filename='image/aguja.jpg') }}", nombre: "Aguja", precio: 25.50, tipo: "res" },
            { img: "{{ url_for('static', filename='image/bistec.jpg') }}", nombre: "Bistec", precio: 28.00, tipo: "res" },
            { img: "{{ url_for('static', filename='image/cadera.jpg') }}", nombre: "Cadera", precio: 23.00, tipo: "res" },
            { img: "{{ url_for('static', filename='image/costillas.jpg') }}", nombre: "Costillas", precio: 30.00, tipo: "res" },
            { img: "{{ url_for('static', filename='image/falda.jpg') }}", nombre: "Falda", precio: 22.50, tipo: "res" },
            { img: "{{ url_for('static', filename='image/lomo.jpg') }}", nombre: "Lomo", precio: 40.00, tipo: "res" },
            { img: "{{ url_for('static', filename='image/malaya.jpg') }}", nombre: "Malaya", precio: 24.50, tipo: "res" },
            { img: "{{ url_for('static', filename='image/pecho.jpg') }}", nombre: "Pecho", precio: 20.00, tipo: "res" },
            { img: "{{ url_for('static', filename='image/solomillo.jpg') }}", nombre: "Solomillo", precio: 45.00, tipo: "res" },
            
            // Productos de cerdo
            { img: "{{ url_for('static', filename='image/chuletas_cerdo.jpg') }}", nombre: "Chuletas", precio: 25.50, tipo: "cerdo" },
            { img: "{{ url_for('static', filename='image/costilla_cerdo.jpg') }}", nombre: "Costillar", precio: 30.00, tipo: "cerdo" },
            { img: "{{ url_for('static', filename='image/panceta_cerdo.jpg') }}", nombre: "Panceta", precio: 28.00, tipo: "cerdo" },
            
            // Productos de pollo
            { img: "{{ url_for('static', filename='image/pechuga_pollo.jpg') }}", nombre: "Pechuga", precio: 15.00, tipo: "pollo" },
            { img: "{{ url_for('static', filename='image/muslo_pollo.jpg') }}", nombre: "Muslo", precio: 12.00, tipo: "pollo" },
            { img: "{{ url_for('static', filename='image/alitas_pollo.jpg') }}", nombre: "Ala", precio: 10.50, tipo: "pollo" },

            // Productos de limpieza
            { img: "{{ url_for('static', filename='image/limpieza1.jpg') }}", nombre: "Limpiador de Parrilla", precio: 23.50, tipo: "limpieza" },
            { img: "{{ url_for('static', filename='image/limpieza2.jpg') }}", nombre: "Cepillo Limpiador", precio: 14.00, tipo: "limpieza" },
            { img: "{{ url_for('static', filename='image/limpieza3.jpg') }}", nombre: "Kit de Limpieza", precio: 26.00, tipo: "limpieza" },

            // Productos de encendido
            { img: "{{ url_for('static', filename='image/encendido1.jpg') }}", nombre: "Gel de encendido", precio: 9.50, tipo: "encendido" },
            { img: "{{ url_for('static', filename='image/encendido2.jpg') }}", nombre: "Cubos de encendido", precio: 14.00, tipo: "encendido" },
            { img: "{{ url_for('static', filename='image/encendido3.jpg') }}", nombre: "Combustible gel", precio: 18.00, tipo: "encendido" },
            { img: "{{ url_for('static', filename='image/encendido4.jpg') }}", nombre: "Trozos de tocón", precio: 31.00, tipo: "encendido" },
            { img: "{{ url_for('static', filename='image/encendido5.jpg') }}", nombre: "Briquetas", precio: 22.50, tipo: "encendido" },

            // Parrillas y equipos
            { img: "{{ url_for('static', filename='image/parrilla1.jpg') }}", nombre: "Parrilla Carbón", precio: 129.50, tipo: "parrilla" },
            { img: "{{ url_for('static', filename='image/parrilla2.jpg') }}", nombre: "Parrilla Gas", precio: 150.00, tipo: "parrilla" },
            { img: "{{ url_for('static', filename='image/parrilla3.jpg') }}", nombre: "Parrilla Portátil", precio: 140.00, tipo: "parrilla" },
            { img: "{{ url_for('static', filename='image/parrilla4.jpg') }}", nombre: "Parrilla Carbón Pequeña", precio: 100.00, tipo: "parrilla" },
            { img: "{{ url_for('static', filename='image/parrilla5.jpg') }}", nombre: "Parrilla Gas Portable", precio: 120.00, tipo: "parrilla" },

            // Cuchillos y utensilios
            { img: "{{ url_for('static', filename='image/pinzas1.jpg') }}", nombre: "Pinzas", precio: 21.50, tipo: "cuchillos" },
            { img: "{{ url_for('static', filename='image/tabla.jpg') }}", nombre: "Tabla y Cuchillo", precio: 35.00, tipo: "cuchillos" },
            { img: "{{ url_for('static', filename='image/juego.jpg') }}", nombre: "Juego de Cuchillos", precio: 25.00, tipo: "cuchillos" },
            { img: "{{ url_for('static', filename='image/blister.jpg') }}", nombre: "Blister", precio: 15.00, tipo: "cuchillos" },
        ];
    </script>
</section>

<!-- PRODUCTOS -->
<section class="py-8 sm:py-12 px-4 sm:px-6">
    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-6 lg:gap-8">
        <!-- SIDEBAR -->
        <aside class="lg:col-span-1 bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-md dark:shadow-lg transition-colors duration-300">
            <h3 class="font-semibold text-base sm:text-lg mb-4 dark:text-white">FILTER BY</h3>
            <div class="mb-4">
                <input type="text" id="search-product" placeholder="Search product..." class="w-full border border-gray-200 dark:border-gray-600 rounded px-3 py-2 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors duration-300">
            </div>

            <div class="mb-4">
                <h4 class="font-medium mb-2 text-sm dark:text-white">Product Type</h4>
                <div class="space-y-2 text-xs sm:text-sm text-gray-700 dark:text-gray-300">
                    <label class="flex items-center cursor-pointer"><input type="checkbox" class="mr-2 type-filter" value="res"> Beef (Res)</label>
                    <label class="flex items-center cursor-pointer"><input type="checkbox" class="mr-2 type-filter" value="cerdo"> Pork (Cerdo)</label>
                    <label class="flex items-center cursor-pointer"><input type="checkbox" class="mr-2 type-filter" value="pollo"> Poultry (Pollo)</label>
                </div>
            </div>

            <div class="mb-4">
                <h4 class="font-medium mb-2 text-sm dark:text-white">Price</h4>
                <div class="flex items-center gap-2">
                    <input id="price-min" type="number" placeholder="Min" class="w-1/2 border border-gray-200 dark:border-gray-600 rounded px-2 py-1 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors duration-300">
                    <input id="price-max" type="number" placeholder="Max" class="w-1/2 border border-gray-200 dark:border-gray-600 rounded px-2 py-1 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 dark:text-white transition-colors duration-300">
                </div>
                <div class="mt-3 flex gap-2 flex-col sm:flex-row">
                    <button id="apply-filters" class="bg-red-600 text-white px-3 sm:px-4 py-2 rounded hover:bg-red-700 text-xs sm:text-sm transition-colors duration-300 font-medium">Apply</button>
                    <button id="reset-filters" class="border border-gray-200 dark:border-gray-600 px-3 sm:px-4 py-2 rounded dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 text-xs sm:text-sm transition-colors duration-300 font-medium">Reset</button>
                </div>
            </div>
        </aside>

        <!-- PRODUCT GRID -->
        <div class="lg:col-span-3">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
                <h2 class="text-xl sm:text-2xl font-bold dark:text-white">Nuestros Productos</h2>
                <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3">
                    <label class="text-xs sm:text-sm dark:text-white">Sort:</label>
                    <select id="sort-home" class="border border-gray-200 dark:border-gray-600 rounded px-3 py-2 text-xs sm:text-sm bg-white dark:bg-gray-800 dark:text-white transition-colors duration-300">
                        <option value="default">Default</option>
                        <option value="precio-asc">Precio: menor a mayor</option>
                        <option value="precio-desc">Precio: mayor a menor</option>
                    </select>
                </div>
            </div>

            <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
                <!-- Jinja loop para renderizar las tarjetas -->
                {% set productos = [
                    ('aguja.jpg', 'Aguja', 25.50, 'res'),
                    ('bistec.jpg', 'Bistec', 28.00, 'res'),
                    ('cadera.jpg', 'Cadera', 23.00, 'res'),
                    ('costillas.jpg', 'Costillas', 30.00, 'res'),
                    ('falda.jpg', 'Falda', 22.50, 'res'),
                    ('lomo.jpg', 'Lomo', 40.00, 'res'),
                    ('malaya.jpg', 'Malaya', 24.50, 'res'),
                    ('pecho.jpg', 'Pecho', 20.00, 'res'),
                    ('solomillo.jpg', 'Solomillo', 45.00, 'res')
                ] %}
                {% for img, nombre, precio, tipo in productos %}
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden product-card p-3 sm:p-4 flex flex-col transition-colors duration-300" data-precio="{{ precio }}" data-tipo="{{ tipo }}">
                    <img src="{{ url_for('static', filename='image/' ~ img) }}" alt="{{ nombre }}" class="w-full h-40 sm:h-44 object-cover rounded mb-3">
                    <div class="flex-grow">
                        <h3 class="text-sm sm:text-lg font-semibold text-gray-800 dark:text-white">{{ nombre }}</h3>
                        <p class="text-red-600 font-bold text-lg sm:text-xl mb-2">S/. {{ '%.2f'|format(precio) }}</p>
                        <p class="text-xs sm:text-sm text-gray-500 dark:text-gray-400 mb-3">Corte de calidad listo para cocinar.</p>
                    </div>
                    <div class="mt-2 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2">
                        <div class="flex items-center gap-2 w-full sm:w-auto">
                            <input type="number" min="1" value="1" class="producto-cantidad w-12 text-center border border-gray-200 dark:border-gray-600 rounded text-xs sm:text-sm dark:bg-gray-700 dark:text-white transition-colors duration-300" />
                            <button class="agregar-carrito bg-red-600 text-white px-2 sm:px-4 py-2 rounded hover:bg-red-700 transition-colors duration-300 text-xs sm:text-sm font-medium flex-1 sm:flex-none" 
                                    data-id="{{ nombre|lower|replace(' ', '_') }}" data-nombre="{{ nombre }}" data-precio="{{ precio }}" data-imagen="{{ url_for('static', filename='image/' ~ img) }}">
                                ADD TO CART
                            </button>
                        </div>
                        <button class="text-xs sm:text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 transition-colors duration-300">READ MORE</button>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- PAGINACIÓN -->
            <div class="mt-8 flex justify-center">
                <nav class="inline-flex -space-x-px flex-wrap gap-1">
                    <a class="px-2 sm:px-3 py-2 border border-gray-200 dark:border-gray-600 rounded-l text-xs sm:text-sm dark:bg-gray-800 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-300">Previous</a>
                    <a class="px-2 sm:px-3 py-2 border border-gray-200 dark:border-gray-600 text-xs sm:text-sm dark:bg-gray-800 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-300">1</a>
                    <a class="px-2 sm:px-3 py-2 border border-gray-200 dark:border-gray-600 text-xs sm:text-sm dark:bg-gray-800 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-300">2</a>
                    <a class="px-2 sm:px-3 py-2 border border-gray-200 dark:border-gray-600 rounded-r text-xs sm:text-sm dark:bg-gray-800 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-300">Next</a>
                </nav>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<!-- Archivo JS para la lógica del Mega Buscador -->
<script src="{{ url_for('static', filename='js/buscador.js') }}"></script>
<!-- Archivo JS Consolidado: Carrito, Carrusel y Filtros de Producto -->
<script src="{{ url_for('static', filename='js/index.js') }}"></script>
{% endblock %}
